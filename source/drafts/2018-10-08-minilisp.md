---
title: 宏扩展的执行逻辑初探
date: 2018-10-08 
author: alenym@qq.com
tags: 
  - lisp 
  - clojure 
  - macro
---

## Lisp中的宏是怎么扩展的呢？

比较流行的编程语言中，`Java`,`Python`都没有定义宏的功能。`c`语言中的宏限制比较大，
没有`Lisp`中的宏强大。以下提到的宏，指的是Lisp方言中的宏。

宏的求值可以分为两个步骤 
1. 扩展（expand）  
2. 求值（eval）

但是，事实上如果我们观察如下一个宏定义`br`，我们期待的扩展的结果是什么呢？

```lisp
(defmacro br (x)
  (if (= x 1)
    (list '+ 1 2)  
    (list '- 2 1)))

(br 1) ;; => ?
```

<!-- more -->

不同的lisp方言有不同的实现。首先看看clojure的实现，然后再看看我最近一致在研究的minilisp的实现。


## Clojure的宏扩展

我们以`Clojure`




## 总结
